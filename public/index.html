<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Encryption Demo JS</title>
    <link rel="stylesheet" href="./styles.css" />
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/atom-one-dark.min.css">
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp"
        crossorigin="anonymous">
    <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>
    <script crossorigin src="./lib/virgil-crypto.browser.umd.js"></script>
    <script crossorigin src="./lib/virgil-sdk.browser.umd.js"></script>
    <script src="./model.js"></script>
</head>

<body>
    <h1>Encryption Demo JS</h1>
    <h4>version 5</h4>
    <div id="intro" class="step">
        <p>This tutorial app explains the basics of using Virgil’s SDK. By the end of the tutorial, you’ll
            be a master of End-to-End Encryption.
        </p>
        <p>
            <b>What is E2EE?</b> When you type in a chat message in your mobile app, it gets “client-side”
            encrypted on the device (or in your browser) and gets decrypted only when your chat partner
            received and displays the message in her chat window.
        </p>
        <img src="images/image-1.png" />
        <p>Because data is encrypted on the client devices, neither the networks, nor the servers/clouds,
            nor you have a clue of what the heck your users are chatting about.
        </p>
        <button show="#step-1" class="center">Get started</button>
    </div>
    <div id="step-1" class="step">
        <h2>Step 1: Create & publish user keys at signup</h2>
        <p>Generate a private & public key for your users when you sign them up.</p>
        <p>
            <i>
                What’s a private/public key pair? You give out your public key to all users, who’ll use it to encrypt
                data for you that only your private key can decrypt.
            </i>
        </p>
        <img src="./images/Image-2.png" />
        <p>
            Lets create cards for Alice and Bob with our createCard function:
        </p>
        <pre class="code-editor" func="Device.prototype.createCard"></pre>
        <pre class="code-editor" snippet="createAliceAndBobCards"></pre>
        <button show="#step-1-1" run="createAliceAndBobCards()">
            <i class="fas fa-play"></i>"run" code
        </button>
        <div id="step-1-1" class="step">
            <pre id="step-1-output">
                <code>creating cards....</code>
			</pre>
            <a target="_blank" href="https://github.com/VirgilSecurity/demo-encryption-js/blob/v5/public/model.js#L30">
                code
            </a>
            <button show="#step-2">Next Step</button>
        </div>
    </div>
    <div id="step-2" class="step">
        <h2>Step 2: Load private keys at login</h2>
        <p>
            In your client-side login routine, load the user’s private key from local storage/keychain. The loadKey
            function will use the platform’s default key store:
        </p>
        <pre class="code-editor" func="Device.prototype.loadKey"></pre>
        <pre class="code-editor" snippet="loadKey"></pre>
        <button show="#step-2-1" run="loadKey()">
            <i class="fas fa-play"></i>"run" code</button>
        <div id="step-2-1" class="step">
            <pre id="step-2-output"></pre>
            <button show="#step-3">Next Step</button>
        </div>
    </div>
    <div id="step-3" class="step">
        <h2>Step 3: End-to-End Encrypt & Decrypt</h2>
        <p>
            Now, your users can simply look up each other’s public keys by their user IDs and encrypt data to each
            other:
        </p>
        <pre class="code-editor" func="Device.prototype.encrypt"></pre>
        <pre class="code-editor" snippet="encrypt"></pre>
        <button show="#step-3-1" run="encrypt()">
            <i class="fas fa-play"></i>"run" code
        </button>
        <div id="step-3-1" class="step">
            <pre id="step-3-1-output">
                <code>// loading bob cards and encrypting message</code>
            </pre>
            <button show="#step-3-2">Next Step</button>
        </div>
        <div id="step-3-2" class="step">
            <pre class="code-editor" func="Device.prototype.decrypt"></pre>
            <pre class="code-editor" snippet="decrypt"></pre>
            <button show="#step-3-3" run="decrypt()">
                <i class="fas fa-play"></i>"run" code
            </button>
            <div id="step-3-3" class="step">
                <pre id="step-3-3-output">
                    // loading bob cards and encrypting message and then decrypting
                </pre>
                <button show="#step-4">Next Step</button>
            </di>
        </div>
    </div>
    <div id="step-4" class="step">
        <h2>And finally: Sign and Verify</h2>
        <p>
            How does Bob know that the message was indeed sent by Alice? Simple: Alice signs the message with her
            private key and Bob verifies the signature using Alice’s public key!
        </p>
        <pre class="code-editor" func="Device.prototype.signThenEncrypt"></pre>
        <pre class="code-editor" snippet="signThenEncrypt"></pre>
        <button show="#step-4-1" run="signThenEncrypt()">
            <i class="fas fa-play"></i>"run" code
        </button>
        <div id="step-4-1" class="step">
            <pre id="step-4-1-output">
                <code>// loading bob cards and encrypting message</code>
            </pre>
            <button show="#step-4-2">Next Step</button>
        </div>
        <div id="step-4-2" class="step">
            <pre class="code-editor" func="Device.prototype.decrypt"></pre>
            <pre class="code-editor" snippet="decryptThenVerify"></pre>
            <button show="#step-4-3" run="decryptThenVerify()">
                <i class="fas fa-play"></i>"run" code
            </button>
            <div id="step-4-3" class="step">
                <pre id="step-4-3-output">
                    // loading bob cards and encrypting message and then decrypting
                </pre>
            </div>
        </div>
    </div>
    <script src="./_renderUtils.js"></script>
    <script src="./snippets.js"></script>
</body>

</html>
